<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1 user-scalable=no">
    <title>MetaMask</title>
    <link rel="stylesheet" type="text/css" href="./index.css" title="ltr">
    <link rel="stylesheet" type="text/css" href="./index-rtl.css" title="rtl" disabled>
  </head>
  <body>
    <div id="app-content">
      <ol id="status">
      </ol>
    </div>
    <script src="./contentscript.js" type="text/javascript" charset="utf-8"></script>
    <script type="module" src="http://localhost:5678/url-wallet.mjs"></script>
    <script>
    window.addEventListener('message', (e)=>{
      if (event.data.method === 'openWindow') {
        window.open(event.data.opts.url)
      } 
    })
    
    const dispStatus = document.getElementById('status')
    const uiMap = new Map()

    function main(bridge) {
      bridge.onqueuechange = (entry, status, queue) => {
        if (!uiMap.has(entry)) {
          const dom = document.createElement('li')
          uiMap.set(entry, dom)
          dispStatus.appendChild(dom)
        }
        const dom = uiMap.get(entry)

        dom.textContent = `${entry.description} -> ${status}`
      }
    }

    </script>
  </body>
</html>
